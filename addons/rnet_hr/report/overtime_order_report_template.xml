<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_overtime_order_document">
        <xpath expr="//t[1]/t[1]/t[1]/t[1]" position="replace">
            <t t-call="web.basic_layout">
                <!-- header -->
                <div class="page">
                    <style type="text/css">
                    table.table-bordered > thead > tr > th {
                        border:1px solid;
                    }
                    table.table-bordered > tbody > tr > td {
                        border:1px solid;
                    }
                    </style>
                    <t t-foreach="docs" t-as="o">
                        <div class="row">
                            <div class="col first-page">
                                <table class="table table-bordered table-sm small ">
                                    <tbody>
                                        <tr>
                                            <td t-att-rowspan="2" colspan="3">
                                                <img src="/web/binary/company_logo" alt="Logo" style="max-height: 60px;"/>
                                            </td>
                                            <td class="text-left">Title</td>
                                            <td class="text-left">: Overtime</td>
                                            <td class="text-left" colspan="2">Doc : No. 2.1.28</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">Revision</td>
                                            <td class="text-left">: 00 </td>
                                            <td class="text-left" colspan="2">Date : 03.02.2020</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </t>


                    <style type="text/css">
                    table.table-bordered > thead > tr > th {
                        border:1px solid;
                    }
                    table.table-bordered > tbody > tr > td {
                        border:1px solid;
                    }
                    </style>
                    <div class="row  mt-2">
                        <div class="col ">
                            <table class="table table-bordered table-sm small ">
                                <tbody>
                                    <tr>
                                        <td class="text-center" t-att-rowspan="4" colspan="3">
                                            <h5>OVERTIME ORDER</h5>
                                            <br/>
                                            <h5>(Surat Permintaan Lembur - SPL )</h5>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="2">SPL No: </td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: bold;" class="text-left" colspan="2">Job Order No :  
                                            <t t-set="jo" t-value="0"/>
                                            <t t-foreach="o.attendances_ids" t-as="line">
                                                <t t-set="jo" t-value="line.project.no"/>
                                            </t>
                                            <t t-esc="jo"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-left" colspan="2">Nama Project :
                                            <t t-set="pn" t-value="0"/>
                                            <t t-foreach="o.attendances_ids" t-as="line">
                                                <t t-if=" line.project">
                                                    <t t-set="pn" t-value="line.project.name[:20]"/>
                                                </t>
                                            </t>
                                            <t t-esc="pn"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row mt-2">
                        <div class="col small text-center">
                            <table class="table table-bordered table-sm small  ">
                                <thead>
                                    <tr>
                                        <th width="8%" class="text-center head">No.</th>
                                        <th width="35%" class="text-center">Name</th>
                                        <th width="13%" class="text-center">position</th>
                                        <th width="7%" class="text-center">Start</th>
                                        <th width="10%" class="text-center">Finish</th>
                                        <th width="23%" class="text-center">Work To Be Done</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    <t t-set="i" t-value="1" />
                                    <t t-foreach="o.attendances_ids.filtered(lambda line: line.gut_class1  or line.gut_class2 or line.gut_class3).sorted(key=lambda x: x.check_in)" t-as="line">
                                        <style type="text/css">
											.highlight  {
											background-color: #D3D3D3 !important;
											}
										</style>
                                        <tr>
                                            <td t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <span t-esc="i"/>
                                                <t t-set="i" t-value="i+1"/>
                                            </td>
                                            <td class="text-left" t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <span t-esc="line.employee_id.name" />
 (                                                <span t-esc="line.check_in.strftime('%d %B %Y')" />
)
                                            </td>
                                            <td style="width: 20%" t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <t t-esc="line.employee_id.job_id.name" />
                                            </td>
                                            <td t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <span t-field="line.start_overtime_hours" t-options="{'format': 'H:mm'}"/>
                                            </td>
                                            <td t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <span t-field="line.check_out" t-options="{'format': 'H:mm'}"/>
                                            </td>
                                            <td class="text-left" t-att-class="'highlight' if line.gut_day in ('Saturday','Sunday') else '' ">
                                                <t t-esc="line.task" />
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                    </div>



                    <div class="row mt-2">
                        <style type="text/css">
                    table.table-bordered > thead > tr > th {
                        border:1px solid;
                    }
                    table.table-bordered > tbody > tr > td {
                        border:1px solid;
                    }
                    .rotate {

  transform: rotate(-90deg);


  /* Legacy vendor prefixes that you probably don't need... */

  /* Safari */
  -webkit-transform: rotate(-90deg);

  /* Firefox */
  -moz-transform: rotate(-90deg);

  /* IE */
  -ms-transform: rotate(-90deg);

  /* Opera */
  -o-transform: rotate(-90deg);

  /* Internet Explorer */
  filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=3);

}

                        </style>
                        <div class="col small">
                            <table class="table table-bordered table-sm">
                                <thead>
                                    <tr>
                                        <th class="border border-dark " style="font-weight:normal;" width="8%" t-att-rowspan="5">
                                            <div  class="text-right rotate">Check Point</div>
                                        </th>
                                        <th style="font-weight:normal;" class="font-smaller">
                                            <div class="text-center">Applicant</div>
                                        </th>
                                        <th style="font-weight:normal;" class="font-smaller">
                                            <div class="text-center">Approved</div>
                                        </th>
                                        <th style="font-weight:normal;" class="font-smaller">
                                            <div class="text-center">Received</div>
                                        </th>
                                    </tr>
                                    <tr>
                                        <td class="border border-dark ">
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                        </td>
                                        <td class="border border-dark ">
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                        </td>
                                        <td class="border border-dark ">
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                            <p>&#160;</p>
                                        </td>
                                    </tr>
                                    <tr>
                                            <td class="border border-dark ">Name :&#160;
                                            </td>
                                            <td class="border border-dark ">Name :&#160;
                                            </td>
                                            <td class="border border-dark ">Name :&#160;</td>
                                        </tr>
                                        <tr>
                                            <td class="border border-dark ">Date :&#160;<span class="text-center" />
                                            </td>
                                            <td class="border border-dark ">Date :&#160;<span class="text-center" />
                                            </td>
                                            <td class="border border-dark ">Date :&#160;<span class="text-center" />
                                            </td>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col small">
                                <span style="font-style: italic;">Note: Send a copy back to requester after completely proccessed</span>
                            </div>
                        </div>

                    </div>

                    <div class="footer">
                            <div class="row">
                                <div class="col-6 small">
                                    <div class="text-left">
                                                                            SPL <span t-field="o.employee_id.name"/>
                                    <span t-field="o.date_start" t-options="{'format': 'MMMM yyyy'}" />
                                </div>
                            </div>
                            <div class="col-6 small">
                                <div class="text-right">
                                                                            Page <span class="page" />
                                                                            of <span class="topage" />
                                </div>
                            </div>
                        </div>
                    </div>

                </t>
            </xpath>
        </template>

        <!-- main template -->
        <template id="report_overtime_order">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="rnet_hr.report_overtime_order_document" />
                </t>
            </t>
        </template>
    </odoo>

